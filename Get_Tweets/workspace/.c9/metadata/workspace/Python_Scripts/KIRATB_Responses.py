{"changed":true,"filter":false,"title":"KIRATB_Responses.py","tooltip":"/Python_Scripts/KIRATB_Responses.py","value":"#-------\n# Victor, use the GetOldTweets to get a list of users who replied to or retweeted KIRATB tweets. \n# I think to do this you will need to search for tweets that mention the KIRATBs.\n#-------\n\n# Take in list of KIRATB\n\n# For each KIRATB call exporter.py with mentions of the KIRATB\nimport os\nimport sys\nfrom subprocess import call\n\nimport Exporter_replies\n\n\ndef find_Tweets(KIRATB_list):\n    for KIRATB in KIRATB_list:\n        # Time is year-month-day\n        #call([\"python\", \"Exporter.py\",\"--querysearch\",KIRATB,\"--maxtweets\", \"3\"])\n        call([\"python\", \"Exporter_replies.py\",\"--since\", \"2016-01-01\", \"--until\", \"2017-11-04\",\"--querysearch\",KIRATB])\n    return\n\n\n# There is no way to check if a tweet is a reply and this removes tweets that reply to KIRATBs\n# Scratch the above, found a way. Use this.\ndef remove_false_positives(csv_file_name, KIRATB_name):\n    print(\"Removing false positives for file: \" + csv_file_name)\n    file_KIRATB = open(csv_file_name, \"r\")\n    new_file = open(KIRATB_name + \"_Users_Tweets.csv\",\"w\")\n    #Skip first line as it holds column names\n    first_row = True\n    for line in file_KIRATB:\n        # Create boolians to see if the KIRATB username shows up in those sections\n        mentioned_in_text = False\n        mentioned_in_mentions = False\n        mentioned_in_replies = False\n        #Skip first line as it holds column names\n        if (first_row):\n            first_row = False\n            new_file.write(line)\n        else:\n            line_list = line.split(\";\")\n            text = line_list[4]\n            replies = line_list[-1]\n            mentions = line_list[6]\n            # Remove @ before usernames\n            # if (mentions[0] != None):\n            #     index = 0\n            #     for name in mentions:\n            #         mentions[index] = name[1:]\n            \n            if KIRATB_name in text:\n                mentioned_in_text = True\n            if KIRATB_name in mentions:\n                mentioned_in_mentions = True\n            if KIRATB_name in replies:\n                mentioned_in_replies = True\n            \n            # If we found the name in one of the sections the line is good.    \n            if (mentioned_in_mentions or mentioned_in_text or mentioned_in_replies):\n                new_file.write(line)\n    print(\"False positives removed\" + \"\\n\")\n    file_KIRATB.close()\n    new_file.close()\n    return       \n\ndef get_usernames(csv_file_name, KIRATB_name):\n    print(\"Finding usernames for file: \" + csv_file_name)\n    username_list = []\n    #os.chdir(\"/home/ubuntu/workspace/Retrieved data/KIRATB_Responses/\")\n    file_KIRATB = open(csv_file_name, \"r\")\n    first_row = True\n    for line in file_KIRATB:\n        line_list = line.split(\";\")\n        #Skip first line as it holds column names\n        if (first_row):\n            first_row = False\n        else:\n            username = line_list[0]\n            username_list.append(username + \",\")\n            #print(username)\n    file_KIRATB.close()\n    new_file = open(KIRATB_name + \"_Usernames.csv\",\"w\")        \n    for user in username_list:\n        new_file.write(user + \"\\n\")\n    new_file.close()\n    print(\"Done finding usernames for file: \" + csv_file_name)\n    return\n\n####################################################################################################################\n# Running Code starts here\n\n#KIRATB_list = [\"2ndHalfOnion\"]\n\nKIRATB_list = []\n\n# NOTE: I (Victor) edited RobbyDelaware out of this list\nfile_KIRATB_list = open(\"KIRATB list.txt\", \"r\")\nfor KIRATB in file_KIRATB_list:\n    KIRATB_list.append(KIRATB)\nfile_KIRATB_list.close()\n\nfind_Tweets(KIRATB_list)\n\n# Go to directory with data\nos.chdir(\"/home/ubuntu/workspace/data/responses_data\")\n\nfor KIRATB in KIRATB_list:\n    remove_false_positives(KIRATB + \".csv\",KIRATB) \n    get_usernames(KIRATB + \"_Users_Tweets.csv\",KIRATB) \n    os.remove(KIRATB + \"_Users_Tweets.csv\")\n    os.remove(KIRATB + \".csv\")\n\n\n\n","undoManager":{"mark":-2,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":11,"column":0},"end":{"row":11,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1525632253210}